<div class="min-h-screen bg-gray-50 p-6">
  <!-- Header with Navigation -->
  <div class="mb-6 border-b border-gray-200 pb-4">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-8">
        <h1 class="text-2xl font-bold text-gray-800">DevCollab</h1>
        <nav class="flex space-x-6">
          <a
            routerLink="/ticketing"
            class="text-gray-600 hover:text-gray-900 transition"
            >Ticketing</a
          >
          <a
            routerLink="/tasks"
            class="text-gray-600 hover:text-gray-900 transition"
            >Tasks</a
          >
          <a
            routerLink="/assets/home"
            class="text-gray-900 font-semibold border-b-2 border-indigo-600 pb-1"
            >Assets</a
          >
        </nav>
      </div>
    </div>
  </div>

  <!-- Breadcrumb and Category Header -->
  <div class="mb-6">
    <div class="flex items-center justify-between">
      <div>
        <!-- Breadcrumb -->
        <nav class="flex items-center space-x-2 text-sm text-gray-600 mb-2">
          <a
            routerLink="/assets/home"
            class="hover:text-indigo-600 transition flex items-center"
          >
            <svg
              class="w-4 h-4 mr-1"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
              />
            </svg>
            Assets Home
          </a>
          <span>/</span>
          <span class="text-gray-900 font-medium">{{
            currentCategoryName
          }}</span>
        </nav>

        <!-- Category Title -->
        <div class="flex items-center space-x-3">
          <h2 class="text-3xl font-bold text-gray-900">
            {{ currentCategoryName }}
          </h2>
          <span
            *ngIf="currentCategoryId"
            class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-sm font-medium"
          >
            {{ filteredAssets.length }} assets
          </span>
        </div>
      </div>

      <!-- Back to Home Button -->
      <button
        (click)="goBackToHome()"
        class="px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition flex items-center shadow-sm"
      >
        <svg
          class="w-5 h-5 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 19l-7-7m0 0l7-7m-7 7h18"
          />
        </svg>
        Back to Home
      </button>
    </div>

    <!-- Category Description (optional) -->
    <p *ngIf="currentCategoryId" class="text-gray-600 mt-2">
      Viewing all assets in the {{ currentCategoryName }} category.
      <button
        *ngIf="currentCategoryId"
        (click)="clearCategoryFilter()"
        class="text-indigo-600 hover:text-indigo-700 underline ml-2"
      >
        View all categories
      </button>
    </p>
  </div>

  <!-- Main Content -->
  <div class="bg-white rounded-lg shadow-sm p-6">
    <!-- Search and Filter Section -->
    <div class="mb-6 space-y-4">
      <!-- Basic Search -->
      <div class="flex items-end space-x-4">
        <div class="flex-1">
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Search</label
          >
          <input
            type="text"
            [(ngModel)]="searchTerm"
            (input)="onSearch()"
            placeholder="Search by name, serial, or owner..."
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
          />
        </div>
        <div class="w-64">
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Type Filter</label
          >
          <select
            [(ngModel)]="typeFilter"
            (change)="onSearch()"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
          >
            <option value="">All Types</option>
            <option *ngFor="let type of types" [value]="type">
              {{ type }}
            </option>
          </select>
        </div>
      </div>

      <!-- Advanced Search Toggle -->
      <button
        (click)="toggleAdvancedSearch()"
        class="text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center"
      >
        {{ showAdvancedSearch ? "âˆ’ Hide" : "+ Show" }} Advanced Search
      </button>

      <!-- Advanced Search Fields -->
      <div
        *ngIf="showAdvancedSearch"
        class="bg-gray-50 p-4 rounded-lg space-y-4 animate-fade-in"
      >
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1"
              >Type</label
            >
            <select
              [(ngModel)]="advancedFilter.type"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"
            >
              <option value="">Select Type</option>
              <option *ngFor="let type of types" [value]="type">
                {{ type }}
              </option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1"
              >Owned By</label
            >
            <select
              [(ngModel)]="advancedFilter.ownedBy"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"
            >
              <option value="">Select Owner</option>
              <option *ngFor="let owner of owners" [value]="owner">
                {{ owner }}
              </option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1"
              >Location</label
            >
            <select
              [(ngModel)]="advancedFilter.location"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"
            >
              <option value="">Select Location</option>
              <option *ngFor="let location of locations" [value]="location">
                {{ location }}
              </option>
            </select>
          </div>
        </div>
        <div class="flex space-x-3">
          <button
            (click)="onAdvancedSearch()"
            class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition"
          >
            Apply Filters
          </button>
          <button
            (click)="clearAdvancedSearch()"
            class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition"
          >
            Clear Filters
          </button>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="mb-6 flex space-x-3">
      <button
        (click)="openAddModal()"
        class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition flex items-center"
      >
        <svg
          class="w-5 h-5 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 4v16m8-8H4"
          />
        </svg>
        Add Asset
      </button>
    </div>

    <!-- Assets Table -->
    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-gray-50 border-b border-gray-200">
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Name
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Serial Number
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Category
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Type
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Brand
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Model
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Status
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Created At
            </th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
              Actions
            </th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let asset of filteredAssets"
            class="border-b border-gray-200 hover:bg-gray-50 transition"
          >
            <td class="px-4 py-3 text-sm text-gray-900 font-medium">
              {{ asset.name }}
            </td>
            <td class="px-4 py-3 text-sm text-gray-700">{{ asset.serialNumber }}</td>
            <td class="px-4 py-3 text-sm text-gray-700">
              {{ getCategoryName(asset.categoryId) }}
            </td>
            <td class="px-4 py-3 text-sm text-gray-700">
              {{ getTypeName(asset.typeId) }}
            </td>
            <td class="px-4 py-3 text-sm text-gray-700">{{ asset.brand || '-' }}</td>
            <td class="px-4 py-3 text-sm text-gray-700">{{ asset.model || '-' }}</td>
            <td class="px-4 py-3">
              <span
                class="px-2 py-1 text-xs rounded-full font-medium"
                [ngClass]="{
                  'bg-green-100 text-green-800': asset.status === 'Active',
                  'bg-blue-100 text-blue-800': asset.status === 'In Use',
                  'bg-yellow-100 text-yellow-800': asset.status === 'Maintenance',
                  'bg-gray-100 text-gray-800': asset.status === 'Retired' || asset.status === 'Storage'
                }"
              >
                {{ asset.status }}
              </span>
            </td>
            <td class="px-4 py-3 text-sm text-gray-600">
              {{ asset.createdAt | date : "short" }}
            </td>
            <td class="px-4 py-3">
              <div class="flex space-x-2">
                <button
                  (click)="openViewModal(asset)"
                  class="px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition"
                >
                  View
                </button>
                <button
                  (click)="openEditModal(asset)"
                  class="px-3 py-1 text-xs bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200 transition"
                >
                  Edit
                </button>
                <button
                  (click)="deleteAsset(asset)"
                  class="px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition"
                >
                  Delete
                </button>
              </div>
            </td>
          </tr>
          <tr *ngIf="filteredAssets.length === 0">
            <td colspan="9" class="px-4 py-8 text-center text-gray-500">
              No assets found. Try adjusting your search criteria.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modals -->
<app-view-asset
  *ngIf="showViewModal && selectedAsset"
  [asset]="selectedAsset"
  [categoryName]="getCategoryName(selectedAsset.categoryId)"
  [typeName]="getTypeName(selectedAsset.typeId)"
  (close)="closeModals()"
  (edit)="openEditModal($event)"
  (delete)="deleteAsset($event)"
></app-view-asset>

<app-add-asset
  *ngIf="showAddModal"
  (close)="closeModals()"
  (save)="onAssetAdded($event)"
></app-add-asset>

<app-edit-asset
  *ngIf="showEditModal && selectedAsset"
  [asset]="selectedAsset"
  [types]="types"
  [locations]="locations"
  (close)="closeModals()"
  (save)="onAssetUpdated($event)"
></app-edit-asset>
